
function [Za, hT] = hilbertS(xT)
%---------------------------------------------------------------------
  %
  
  %---------------------------------------------------------------------
  % Find input array length and calculate its FT
  %---------------------------------------------------------------------
  %
  Nt=length(xT);
  evenNt=1-mod(Nt,2);
  Nt_h=round( (Nt+1-evenNt)/2 , 0 );
  %
  xF=fft(xT);
  %
  %---------------------------------------------------------------------
  % Construct FT of Hilbert kernel
  %---------------------------------------------------------------------
  %
  hF=2.0*ones(1,Nt);
  hF(1)=1.0;
  hF(Nt_h+1)=evenNt;
  hF((Nt_h+2):Nt)=0.0;
  %
  %---------------------------------------------------------------------
  % Calculate analytic signal, Za, and Hilbert kernel, hT, 
  % by IFT to time domain
  %---------------------------------------------------------------------
  %
  Za=ifft(xF.*hF);
  hT=ifft(hF);
end